<Page
    x:Class="HUDRA.Pages.ScalingPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:HUDRA.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Page.Resources>
        <controls:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    </Page.Resources>

    <Grid Margin="0">
        <StackPanel
            MaxWidth="280"
            Margin="0,15,0,0"
            HorizontalAlignment="Center"
            VerticalAlignment="Top"
            Spacing="20">

            <Border>
                <TextBlock
                    Padding="0,15,0,0"
                    HorizontalAlignment="Center"
                    FontFamily="Cascadia Code"
                    FontSize="18"
                    FontWeight="SemiBold"
                    Text="SCALING" />
            </Border>

            <!--  Upscaling Toggle  -->
            <Border
                Width="280"
                Padding="20,15"
                Background="#22FFFFFF"
                CornerRadius="12">
                <StackPanel Spacing="8">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="4*" />
                            <ColumnDefinition Width="1*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Column="0"
                            VerticalAlignment="Center"
                            FontFamily="Cascadia Code"
                            FontSize="14"
                            FontWeight="SemiBold"
                            Text="Upscaling" />
                        <ToggleSwitch
                            x:Name="UpscalingToggle"
                            Grid.Column="1"
                            IsOn="{Binding UpscalingEnabled, Mode=TwoWay}" />
                    </Grid>

                    <!--  Upscaling Description  -->
                    <StackPanel Spacing="10">
                        <TextBlock
                            FontFamily="Cascadia Code"
                            FontSize="12"
                            Opacity="0.7"
                            Text="Enables LS1 scaling for sharper image quality."
                            TextWrapping="Wrap" />
                        <TextBlock
                            FontFamily="Cascadia Code"
                            FontSize="12"
                            Opacity="0.7"
                            TextWrapping="Wrap">
                            <Run Text="Run games in windowed mode at" />
                            <Run FontWeight="SemiBold" Text="{Binding OptimalGameResolution, Mode=OneWay}" />
                            <Run Text="for optimal results. (Scales perfectly to your" />
                            <Run Text="{Binding NativeResolution, Mode=OneWay}" />
                            <Run Text="display.)" />
                        </TextBlock>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!--  Frame Generation Multiplier  -->
            <Border
                Padding="20,15"
                Background="#22FFFFFF"
                CornerRadius="12">
                <StackPanel Spacing="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Column="0"
                            FontFamily="Cascadia Code"
                            FontSize="14"
                            FontWeight="SemiBold"
                            Text="Frame Generation" />
                        <TextBlock
                            Grid.Column="1"
                            FontFamily="Cascadia Code"
                            FontSize="12"
                            Text="{Binding FrameGenLabel, Mode=OneWay}" />
                    </Grid>
                    <Slider
                        x:Name="FrameGenSlider"
                        Maximum="4"
                        Minimum="1"
                        StepFrequency="1"
                        TickFrequency="1"
                        TickPlacement="BottomRight"
                        Value="{Binding FrameGenSelectedIndex, Mode=TwoWay}" />

                    <!--  Frame Generation Description  -->
                    <StackPanel Spacing="10">
                        <TextBlock
                            FontFamily="Cascadia Code"
                            FontSize="12"
                            Opacity="0.7"
                            Text="Generates additional frames between real frames to increase smoothness."
                            TextWrapping="Wrap" />
                        <TextBlock
                            FontFamily="Cascadia Code"
                            FontSize="12"
                            Opacity="0.7"
                            Text="Higher settings may impact visual quality. Start with 2x and adjust as needed."
                            TextWrapping="Wrap" />
                    </StackPanel>
                </StackPanel>
            </Border>

            <!--  Flow Scale Slider  -->
            <Border
                Padding="20,15"
                Background="#22FFFFFF"
                CornerRadius="12">
                <StackPanel Spacing="10">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.Column="0"
                            FontFamily="Cascadia Code"
                            FontSize="14"
                            FontWeight="SemiBold"
                            Text="Flow Scale" />
                        <TextBlock
                            Grid.Column="1"
                            FontFamily="Cascadia Code"
                            FontSize="12"
                            Text="{Binding FlowScale, Mode=OneWay}" />
                    </Grid>
                    <Slider
                        x:Name="FlowScaleSlider"
                        Maximum="100"
                        Minimum="0"
                        Value="{Binding FlowScale, Mode=TwoWay}" />

                    <!--  Flow Scale Description  -->
                    <StackPanel Spacing="10">
                        <TextBlock
                            FontFamily="Cascadia Code"
                            FontSize="12"
                            Opacity="0.7"
                            Text="Fine-tunes frame generation quality vs performance."
                            TextWrapping="Wrap" />
                        <TextBlock
                            FontFamily="Cascadia Code"
                            FontSize="12"
                            Opacity="0.7"
                            Text="Lower values (0-30) prioritize performance. Higher values (70-100) prioritize quality."
                            TextWrapping="Wrap" />
                    </StackPanel>
                </StackPanel>
            </Border>

            <!--  Action Buttons  -->
            <StackPanel
                HorizontalAlignment="Center"
                Orientation="Horizontal"
                Spacing="15">
                <Button
                    x:Name="ApplyButton"
                    Width="75"
                    Height="40"
                    Click="ApplyButton_Click"
                    Content="Apply" />
                <Button
                    x:Name="ResetButton"
                    Width="75"
                    Height="40"
                    Click="ResetButton_Click"
                    Content="Reset" />
                <Button
                    x:Name="RestoreButton"
                    Width="75"
                    Height="40"
                    Click="RestoreButton_Click"
                    Content="Restore"
                    ToolTipService.ToolTip="Restore your backed-up Lossless Scaling settings." />
            </StackPanel>

            <!--  Status/Progress  -->
            <Border
                x:Name="StatusBorder"
                Padding="10"
                Background="Transparent"
                Visibility="{Binding IsApplying, Mode=OneWay, Converter={StaticResource BooleanToVisibilityConverter}}">
                <StackPanel
                    HorizontalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="10">
                    <ProgressRing
                        Width="20"
                        Height="20"
                        Foreground="White"
                        IsActive="True" />
                    <TextBlock
                        FontFamily="Cascadia Code"
                        FontSize="12"
                        Text="{Binding StatusMessage, Mode=OneWay}" />
                </StackPanel>
            </Border>

        </StackPanel>
    </Grid>
</Page>